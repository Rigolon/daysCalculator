new Vue({el:"#app",data:{calcLoading:!1,config:{chronoEraStep:88},form:{cicle:88,min:1,max:3333,etherium:null,timeMint:null,chronoPower:null,tokensDayZero:null,etheriumAddress:null},chronoEra:{},page:1,pagination:50,url:"https://etherchain.org/api/account/0xA723606e907bF84215d5785Ea7f6cD93A0Fbd121/tx/",transactions:[],transactionsAgrouped:{},startDate1:"2017-08-28T13:00:00.000Z",startDate2:"2017-08-28T19:00:00.000Z",amountStartDate:5},mounted:function(){var c=this,d={};for(i=1;40>=i;i++)d[i]={era:Math.ceil(i/4),initDay:c.config.chronoEraStep*i-c.config.chronoEraStep+1,lastDay:c.config.chronoEraStep*i,effective:1==i?1:d[i-1].effective/2};c.chronoEra=d,c.getPositionsTransaction()},methods:{getAddress:function(){if(!!this.transactionsAgrouped[this.form.etheriumAddress]){var c=0,d=this.transactionsAgrouped[this.form.etheriumAddress];for(i=0;i<d.length;i++)c+=d[i].amountFormated;this.form.etherium=c+"";var e=Object.keys(this.transactionsAgrouped).indexOf(this.form.etheriumAddress)+1;1e3<e&&(e+=300),this.form.timeMint=e,this.formEtherium(this.form.etherium)}else!this.form.etheriumAddress||(swal("Oops..",msgAlert,"error").catch(swal.noop),this.form.etheriumAddress=null)},getTransactions:function(c){var d=this,e=d.url,f=d.pagination*c-d.pagination;this.$http.get(e+f).then(function(g){g.body.data.length?(d.transactions=d.transactions.concat(g.body.data),setTimeout(function(){d.getTransactions(c+1)},1e4)):console.log(d.transactions)},function(){})},getPositionsTransaction:function(){for(var c=this,d=transactions,e={},f=0;f<d.length;f++){var g=!1,h=d[f];h.amountFormated=h.amount/1e18,moment(h.time).isSameOrAfter(c.startDate1)&&5<=h.amountFormated&&(g=!0),!g&&moment(h.time).isSameOrAfter(c.startDate2)&&1<=h.amountFormated?g=!0:e[h.sender]!==void 0&&(g=!0),g&&h.gasLimit==h.gasUsed&&(g=!1),g&&(e[h.sender]===void 0&&(e[h.sender]=[]),e[h.sender].push(h))}e=_.fromPairs(_.sortBy(_.toPairs(e),function(j){return new Date(j.time)}).reverse()),c.transactionsAgrouped=e},formEtherium:function(c){var d=+(c+"").replace(",",".");if(!!!d)this.form.etherium=null,this.form.chronoPower=null,this.form.tokensDayZero=null;else if(1>d)swal("Oops",msgAlert2,"error").catch(swal.noop),this.form.etherium=null,this.form.chronoPower=null,this.form.tokensDayZero=null;else{this.form.tokensDayZero=24*d}}},watch:{"form.timeMint":function(c){var d=this;if(+c<this.form.min)return void d.$nextTick(function(){this.form.timeMint=this.form.min});if(+c>this.form.max)return void d.$nextTick(function(){this.form.timeMint=this.form.max});var e=+c;if(!!e){this.form.chronoPower=100*(0.01-5e-3*(e-1)/3332)+""}}},computed:{simulations:function(){var c=[],d=this;if(!!d.form.timeMint&&!!d.form.chronoPower){d.calcLoading=!0;var e=d.form.tokensDayZero;for(item in d.chronoEra){var f=d.chronoEra[item],g=e;1<item&&(void 0!==f[item-2]&&(e+=f[item-2].diff),g=c[item-2].last);var h=f.effective,j=this.form.chronoPower,k=h*j,l=Math.pow(1+k/100,d.config.chronoEraStep),m=g*l;c.push({chronoPower:k,period:item,start:+g,last:m,diff:m-g})}}return d.calcLoading=!1,c}}});